DELIMITER //
 
CREATE PROCEDURE emitirReporte(xinicio date, xfin date, xorigen varchar(50), xdestino varchar(50))
BEGIN

DECLARE cantCancelados int default 0;
DECLARE reintegrado float default 0;

IF (xorigen IS NULL and xdestino IS NULL) THEN
	select count(*) INTO cantCancelados from ticket where DATE(start_date) between xinicio and xfin;
    select sum(price) INTO reintegrado from ticket where DATE(start_date) between xinicio and xfin;
END IF;
IF (xorigen IS NULL) THEN
	select count(*) INTO cantCancelados from ticket where destination_place=xdestino and DATE(start_date) between xinicio and xfin;
    select sum(price) INTO reintegrado from ticket where destination_place=xdestino and DATE(start_date) between xinicio and xfin;
END IF;
IF (xdestino IS NULL) THEN
	select count(*) INTO cantCancelados from ticket where origin_place=xorigen and DATE(start_date) between xinicio and xfin;
    select sum(price) INTO reintegrado from ticket where origin_place=xorigen and DATE(start_date) between xinicio and xfin;
ELSE
	select count(*) INTO cantCancelados from ticket where origin_place=xorigen and destination_place=xdestino and DATE(start_date) between xinicio and xfin;
	select sum(price) INTO reintegrado from ticket where origin_place=xorigen and destination_place=xdestino and DATE(start_date) between xinicio and xfin;
END IF;

END //
 
DELIMITER ;